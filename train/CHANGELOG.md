# 更新日志

## v2.1.0 - 2024-12-19

### 🚀 性能优化
- **快速响应**: 检测响应时间从10秒优化到1-2秒
- **更频繁预测**: 预测频率从每0.5秒提升到每0.33秒
- **智能平滑算法**: 优化预测平滑逻辑，最少2次预测即可给出结果
- **多级判定机制**: 
  - 高置信度快速检测（2次高置信度预测）
  - 连续预测确认（最近一次高置信度+历史预测）
  - 持续行为检测（连续中等置信度预测）

### 📁 新增文件
- `test_fast_response.py` - 快速响应测试脚本

## v2.0.0 - 2024-12-19

### 🎉 新功能
- **外部可视化面板**: 信息显示在视频右侧，不再遮挡原始视频画面
- **扩展输出分辨率**: 输出视频宽度 = 原视频宽度 + 400像素信息面板
- **稳定RTSP流可视化**: 所有帧都显示最新预测结果，消除闪烁问题
- **丰富的信息面板**: 包含标题、主要结果、置信度条、类别概率、视频信息等
- **盗窃警报横幅**: 检测到盗窃时显示醒目的红色警告

### 🐛 问题修复
- **修复RTSP流闪烁**: 之前只有预测帧显示可视化信息，现在所有帧都显示
- **修复NaN错误**: 解决了平滑预测函数在没有历史数据时返回NaN的问题
- **修复数据类型错误**: 解决了`torch.cuda.DoubleTensor`和`torch.cuda.FloatTensor`不匹配的问题
- **修复置信度显示**: 添加了安全检查，确保置信度值始终有效

### 🔧 改进
- **更好的错误处理**: 添加了更多的边界检查和异常处理
- **优化代码结构**: 将可视化逻辑模块化，便于维护
- **改进用户体验**: 信息面板布局更清晰，信息显示更直观

### 📁 新增文件
- `test_external_viz.py` - 测试外部可视化面板效果
- `test_rtsp_stable.py` - 测试稳定的RTSP流可视化
- `CHANGELOG.md` - 本更新日志文件

### 🔄 修改文件
- `test_model.py` - 主要修改，实现外部可视化面板和稳定RTSP流显示
- `TEST_README.md` - 更新文档，说明新功能和修复的问题

## v1.0.0 - 2024-12-18

### 🎉 初始版本
- 基本的视频文件测试功能
- RTSP流测试支持
- 批量测试功能
- 基本的可视化界面（覆盖在视频上）
- 模型加载和推理功能 